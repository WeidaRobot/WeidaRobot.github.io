webpackJsonp([3],{"+Xlh":function(t,e,a){var o=a("NhQv");"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);a("rjj0")("008b1f56",o,!0)},"3JF8":function(t,e,a){var o=a("SJe0");"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);a("rjj0")("47349870",o,!0)},"7Src":function(t,e,a){"use strict";e.j=function(t){return Object(o.a)({url:"/rest/robots/pause",method:"post",contentType:"application/json",headers:{authorization:Object(n.a)()},data:t})},e.i=function(t){return Object(o.a)({url:"/rest/robots/resume",method:"post",contentType:"application/json",headers:{authorization:Object(n.a)()},data:t})},e.c=function(t){return Object(o.a)({url:"/rest/magicbox/exclude",method:"post",contentType:"application/json",headers:{authorization:Object(n.a)()},data:t})},e.e=function(t){return Object(o.a)({url:"/rest/robots/states/",method:"post",contentType:"application/json",headers:{authorization:Object(n.a)()},data:t})},e.m=function(t){return Object(o.a)({url:"/rest/schedulers/start",method:"post",contentType:"application/json",headers:{authorization:Object(n.a)()},data:{mapId:t}})},e.o=function(t){return Object(o.a)({url:"/rest/schedulers/stop",method:"post",contentType:"application/json",headers:{authorization:Object(n.a)()},data:{mapId:t}})},e.l=function(t){return Object(o.a)({url:"/rest/schedulers/resume",method:"post",contentType:"application/json",headers:{authorization:Object(n.a)()},data:{mapId:t}})},e.k=function(t){return Object(o.a)({url:"/rest/schedulers/pause",method:"post",contentType:"application/json",headers:{authorization:Object(n.a)()},data:{mapId:t}})},e.n=function(t){return Object(o.a)({url:"/rest/schedulers/status",method:"post",contentType:"application/json",headers:{authorization:Object(n.a)()},data:{mapId:t}})},e.g=function(t){return Object(o.a)({url:"/rest/robots/poweron",method:"post",contentType:"application/json",headers:{authorization:Object(n.a)()},data:{robotIds:t}})},e.f=function(t){return Object(o.a)({url:"/rest/robots/poweroff",method:"post",contentType:"application/json",headers:{authorization:Object(n.a)()},data:{robotIds:t}})},e.b=function(t){return Object(o.a)({url:"/rest/tasks/statistics",method:"post",contentType:"application/json",headers:{authorization:Object(n.a)()},data:{mapId:t}})},e.d=function(t){return Object(o.a)({url:"/rest/tasks/put",method:"post",contentType:"application/json",headers:{authorization:Object(n.a)()},data:t})},e.h=function(t){return Object(o.a)({url:"/rest/robots/stopCharging",method:"post",contentType:"application/json",headers:{authorization:Object(n.a)()},data:t})},e.a=function(t){return Object(o.a)({url:"/rest/robots/cancelTask",method:"post",contentType:"application/json",headers:{authorization:Object(n.a)()},data:t})};var o=a("vLgD"),n=a("TIfe")},"9Aod":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=a("BO1k"),n=a.n(o),r=a("mvHQ"),i=a.n(r),l=a("//Fk"),s=a.n(l),c=a("7Src"),d=function(t){if("function"!=typeof t)throw new TypeError("被装饰的必须是函数");return function(){for(var e=arguments.length,a=Array(e),o=0;o<e;o++)a[o]=arguments[o];var n=[].concat(a),r=n[0],i=n[1];if(!r.sels.length)return r.notify("请先勾选,而后操作");r.sels.map(function(e){if(r.robots.filter(function(t){return t.id===e.id&&!i&&!t.online}).length)return r.notify("机器"+e.id+"已离线,无法下发指令","warning");t(e)})}},p=function(t,e,a,o,n){t(e).then(function(t){a.$notify.success("机器"+o+n+"指令已下发")},function(t){a.notify("机器"+o+n+"指令下发失败","error")})},u=function(t){if("function"!=typeof t)throw new TypeError("被装饰的必须是函数");return function(){for(var e=arguments.length,a=Array(e),o=0;o<e;o++)a[o]=arguments[o];var n=[].concat(a),r=n[0],i=n[1];if(!r.sels.length)return r.notify("请先勾选,而后操作");var l=[];r.sels.map(function(t){return r.robots.filter(function(e){return e.id===t.id&&!i&&!e.online}).length?r.notify("机器"+t.id+"已离线,无法下发指令","warning"):i&&t.online?r.notify("机器"+t.id+"已然是开机状态,无法下发指令","warning"):void l.push(t.id)}),t(l)}},b=function(t,e,a,o){t(e).then(function(t){a.$notify.success("机器"+e+o+"指令已下发")},function(t){a.notify("机器"+e+o+"指令下发失败","error")})},g=function(t,e){return e(t)},f=a("6Y32"),h=a("pPmT"),v={data:function(){return{robots:[],robotscopy:[],sels:[],listLoading:!0,robotTimer:null,notifyPromise:s.a.resolve(),rbForm:{id:null,state:"all"},batteryCapLowerLimit:0,dialogFormVisible:!1,detailId:null,details:null,detail_timer:null,items:{state_all:0,state_online:0,state_offline:0,state_except:0,state_exclude:0,state_repair:0},error_msg:null}},computed:{},mounted:function(){this.loadconfig(),this.robotTimer||(this.robotTimer=setInterval(this.onrefresh,1e3))},beforeDestroy:function(){this.robotTimer&&clearInterval(this.robotTimer)},methods:{getColor:function(t){return t>this.batteryCapLowerLimit?"#22B14C":"#ED1C24"},getRowKeys:function(t){return t.id},loadconfig:function(){var t=this;Object(f.g)("charge").then(function(e){e.data.result?t.batteryCapLowerLimit=e.data.data.lowerLimit:console.log(e.data.comment)},function(t){console.log(t)})},onrefresh:function(){var t=this,e=this;Object(c.e)({params:{id:[]}}).then(function(a){try{var o=function(t){var e=[];return t.forEach(function(t){e.push(parseFloat(t).toFixed(6))}),e},r=a.data.data?a.data.data:[],l=[],s=!0,c=!1,d=void 0;try{for(var p,u=n()(r);!(s=(p=u.next()).done);s=!0){var b=p.value;l.push({id:b.id,mapId:b.mapId,areaId:b.position.areaId,online:b.online,agvState:b.agvState,batteryCap:parseFloat(b.battery).toFixed(3),powerState:b.powerState,taskState:b.taskState,taskId:b.taskId,loaded:b.loaded,ip:b.ip,xy_angle:parseFloat(b.position.x).toFixed(3)+" ，"+parseFloat(b.position.y).toFixed(3)+" ，"+parseFloat(b.position.angle).toFixed(3),target_xy_angle:parseFloat(b.target.x).toFixed(3)+" ，"+parseFloat(b.target.y).toFixed(3)+" ，"+parseFloat(b.target.angle).toFixed(3),epsilon_xy_angle:parseFloat(b.epsilon.x).toFixed(3)+" ，"+parseFloat(b.epsilon.y).toFixed(3)+" ，"+parseFloat(b.epsilon.angle).toFixed(3),twist_linear_Ou:o(b.twist.linear),twist_angular_Ou:o(b.twist.angular),acceleration_linear_0u:o(b.acceleration.linear),acceleration_angular_0u:o(b.acceleration.angular),podId:b.podId,podAngle:parseFloat(b.podAngle).toFixed(3),agvType:b.agvType,length_width_height:b.length+" ，"+b.width+" ，"+b.height})}}catch(t){c=!0,d=t}finally{try{!s&&u.return&&u.return()}finally{if(c)throw d}}t.items.state_all=l.length,t.items.state_online=l.filter(function(t){return t.online}).length,t.items.state_offline=l.filter(function(t){return!t.online}).length,t.items.state_except=l.filter(function(t){return"initializing"===t.agvState}).length,t.robots=l.filter(function(t){return e.stateBool(e.rbForm.state,t)&&(!e.rbForm.id||t.id===e.rbForm.id)}),e.robotscopy=JSON.parse(i()(t.robots)),e.error_msg=null}catch(t){e.error_msg=e.$t("robot.error_data_msg")}},function(t){console.log(t)}),this.listLoading=!1},formatDest:function(t,e){return{true:this.$t("robot.state_agv_true"),false:this.$t("robot.state_agv_false"),idle:this.$t("robot.state_agv_idle"),emergency:this.$t("robot.state_agv_emergency"),running:this.$t("robot.state_agv_running"),charging:this.$t("robot.state_agv_charging"),initializing:this.$t("robot.state_agv_except")}[t.agvState]},formatTask:function(t,e){return{initializing:this.$t("robot.state_task_initializing"),idle:this.$t("robot.state_task_idle"),running:this.$t("robot.state_task_running"),charging:this.$t("robot.state_task_charging"),exception:this.$t("robot.state_task_exception")}[t.taskState]},formatOnline:function(t,e){return t.online?this.$t("robot.state_online"):this.$t("robot.state_offline")},formatLoaded:function(t,e){return t.loaded?this.$t("robot.state_loaded_true"):this.$t("robot.state_loaded_false")},stateBool:function(t,e){var a=!0;switch(t){case"all":a=!0;break;case"true":a=!0===e.online;break;case"false":a=!1===e.online;break;case"idle":a="idle"===e.agvState;break;case"running":a="running"===e.agvState;break;case"charging":a="charging"===e.agvState;break;case"initializing":a="initializing"===e.agvState}return a},statefilter:function(t){var e=this;this.$refs.robotTable.clearSelection(),this.robots=this.robotscopy.filter(function(a){return e.stateBool(t,a)&&(!e.rbForm.id||a.id===e.rbForm.id)})},searFocus:function(){this.$refs.robotTable.clearSelection()},search:function(){var t=this;this.robots=this.robotscopy.filter(function(e){return!("all"!==t.rbForm.state&&t.rbForm.state!==e.agvState||t.rbForm.id&&e.id!==t.rbForm.id)})},reset:function(){this.$refs.rbForm.resetFields(),this.$refs.robotTable.clearSelection(),this.robots=this.robotscopy},selsChange:function(t){this.sels=t},notify:function(t){var e=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"warning";this.notifyPromise=this.notifyPromise.then(this.$nextTick).then(function(){var o={title:"error"===a?"指令失败":"提示",message:t,duration:8e3};"error"===a?e.$notify.error(o):e.$notify.warning(o)})},agvreboot:function(){var t=this;g(function(e){if(e.length<1)return;b(c.g,e,t,"开机")},u)(t,!0)},agvshutdown:function(){var t=this;g(function(e){if(e.length<1)return;b(c.f,e,t,"关机")},u)(t)},agvcharge:function(){var t=this;g(function(e){var a=Object(h.b)(),o={mapId:e.mapId,robotId:e.id,taskId:a,taskType:1};p(c.d,o,t,e.id,"充电")},d)(t)},agvchargestop:function(){var t=this;g(function(e){var a={robotId:e.id};p(c.h,a,t,e.id,"停止充电")},d)(t)},cancelTask:function(){var t=this;g(function(e){var a={robotId:e.id};p(c.a,a,t,e.id,"取消任务")},d)(t)},agvstop:function(){var t=this;g(function(e){var a={mapId:e.mapId,robotId:e.id};p(c.j,a,t,e.id,"停止")},d)(t)},agvresume:function(){var t=this;g(function(e){var a={mapId:e.mapId,robotId:e.id};p(c.i,a,t,e.id,"恢复")},d)(t)},agvexclude:function(){var t=this;g(function(e){var a={mapId:e.mapId,robotId:e.id};p(c.c,a,t,e.id,"排除")},d)(t)},agvcancel:function(){},detailInfo:function(t,e){this.dialogFormVisible=!0,this.detailId=e.id},link_mrs:function(t,e){window.open("http://"+e.ip)},onopen:function(){var t=this;function e(){t.details=t.robots.filter(function(e){return e.id===t.detailId})[0]}e(),this.detail_timer=setInterval(e,1e3)},oncancel:function(){clearInterval(this.detail_timer),this.detailId=null,this.details=null}}},_={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("el-form",{ref:"rbForm",attrs:{inline:!0,model:t.rbForm},nativeOn:{submit:function(t){t.preventDefault()}}},[a("el-form-item",{attrs:{prop:"id"}},[a("el-input",{attrs:{placeholder:t.$t("robot.number"),size:"small",type:"number"},on:{focus:t.searFocus},model:{value:t.rbForm.id,callback:function(e){t.$set(t.rbForm,"id",t._n(e))},expression:"rbForm.id"}})],1),t._v(" "),a("el-form-item",{attrs:{prop:"state"}},[a("el-select",{attrs:{placeholder:t.$t("robot.state"),size:"small"},on:{change:t.statefilter},model:{value:t.rbForm.state,callback:function(e){t.$set(t.rbForm,"state",e)},expression:"rbForm.state"}},[a("el-option",{attrs:{label:t.$t("robot.state_all"),value:"all"}}),t._v(" "),a("el-option",{attrs:{label:t.$t("robot.state_online"),value:"true"}}),t._v(" "),a("el-option",{attrs:{label:t.$t("robot.state_offline"),value:"false"}}),t._v(" "),a("el-option",{attrs:{label:t.$t("robot.state_idle"),value:"idle"}}),t._v(" "),a("el-option",{attrs:{label:t.$t("robot.state_running"),value:"running"}}),t._v(" "),a("el-option",{attrs:{label:t.$t("robot.state_charging"),value:"charging"}}),t._v(" "),a("el-option",{attrs:{label:t.$t("robot.state_except"),value:"initializing"}})],1)],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{icon:"el-icon-search",size:"small",type:"primary"},on:{click:t.search}},[t._v(t._s(t.$t("btn.search")))]),t._v(" "),a("el-button",{attrs:{icon:"el-icon-delete",size:"small",type:"primary"},on:{click:t.reset}},[t._v(t._s(t.$t("btn.reset")))])],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{icon:"el-icon-video-play",size:"small",type:"success"},on:{click:t.agvreboot}},[t._v(t._s(t.$t("robot.agv_reboot"))+"\n        ")]),t._v(" "),a("el-button",{attrs:{icon:"el-icon-switch-button",size:"small",type:"warning"},on:{click:t.agvshutdown}},[t._v("\n          "+t._s(t.$t("robot.agv_shutdown"))+"\n        ")]),t._v(" "),a("el-button",{attrs:{icon:"el-icon-video-pause",size:"small",type:"warning"},on:{click:t.agvstop}},[t._v(t._s(t.$t("robot.agv_stop"))+"\n        ")]),t._v(" "),a("el-button",{attrs:{icon:"el-icon-refresh",size:"small",type:"warning"},on:{click:t.agvresume}},[t._v(t._s(t.$t("robot.agv_resume"))+"\n        ")]),t._v(" "),a("el-button",{attrs:{icon:"el-icon-video-play",size:"small",type:"success"},on:{click:t.agvcharge}},[t._v("\n          "+t._s(t.$t("robot.start_charge"))+"\n        ")]),t._v(" "),a("el-button",{attrs:{icon:"el-icon-video-pause",size:"small",type:"warning"},on:{click:t.agvchargestop}},[t._v("\n          "+t._s(t.$t("robot.stop_charge"))+"\n        ")]),t._v(" "),a("el-button",{attrs:{icon:"el-icon-video-pause",size:"small",type:"warning"},on:{click:t.cancelTask}},[t._v("\n          "+t._s(t.$t("robot.stop_task"))+"\n        ")])],1)],1),t._v(" "),a("el-row",{staticClass:"robot-overall-pane-wrapper"},t._l(t.items,function(e,o){return a("el-col",{key:o,staticClass:"pane-box",attrs:{span:4}},[a("div",{staticClass:"pane-detail"},[a("span",[t._v(t._s(t.$t("robot."+o))+":")]),t._v(" "),a("span",[t._v(t._s(e))])])])}),1),t._v(" "),a("el-table",{ref:"robotTable",attrs:{data:t.robots,"header-cell-style":{"text-align":"center",background:"#F5F7FA"},"row-key":t.getRowKeys,size:"small","highlight-current-row":"",stripe:"",width:"100%"},on:{"selection-change":t.selsChange}},[a("template",{slot:"empty"},[t.error_msg?a("span",{staticStyle:{color:"#ff7381"}},[t._v(t._s(t.error_msg))]):a("span",[t._v(t._s(t.$t("robot.null_data_msg")))])]),t._v(" "),a("el-table-column",{attrs:{"reserve-selection":!0,align:"center",type:"selection",width:"50"}}),t._v(" "),a("el-table-column",{attrs:{label:t.$t("robot.index"),align:"center",type:"index",width:"60"}}),t._v(" "),a("el-table-column",{attrs:{label:t.$t("robot.number"),align:"center",prop:"id",width:"120",sortable:""}}),t._v(" "),a("el-table-column",{attrs:{label:t.$t("robot.mapId"),align:"center",prop:"mapId"}}),t._v(" "),a("el-table-column",{attrs:{label:t.$t("robot.areaId"),align:"center",prop:"areaId"}}),t._v(" "),a("el-table-column",{attrs:{label:t.$t("robot.ip"),align:"center",prop:"ip"}}),t._v(" "),a("el-table-column",{attrs:{formatter:t.formatOnline,label:t.$t("robot.agv_table_online"),align:"center",prop:"online"}}),t._v(" "),a("el-table-column",{attrs:{formatter:t.formatDest,label:t.$t("robot.agv_table_agvState"),align:"center",prop:"agvState"}}),t._v(" "),a("el-table-column",{attrs:{label:t.$t("robot.agv_table_batteryCap"),align:"center",prop:"batteryCap"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"battery-box",staticStyle:{width:"100%"}},[a("div",{style:{background:t.getColor(e.row.batteryCap),height:"15px",width:e.row.batteryCap+"%",BorderRadius:"5px",backgroundSize:"10%"}},[a("div",{staticClass:"battery-span"},[t._v(t._s(e.row.batteryCap+"%"))])])])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:t.$t("robot.agv_table_coordinates"),align:"center",prop:"xy_angle",width:"300"}}),t._v(" "),a("el-table-column",{attrs:{formatter:t.formatTask,label:t.$t("robot.agv_table_taskState"),align:"center",prop:"taskState"}}),t._v(" "),a("el-table-column",{attrs:{formatter:t.formatLoaded,label:t.$t("robot.agv_table_loaded"),align:"center",prop:"loaded"}}),t._v(" "),a("el-table-column",{attrs:{label:t.$t("robot.agv_table_detail"),align:"center",prop:"detail"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{plain:"",size:"mini",type:"primary"},on:{click:function(a){return t.detailInfo(e.$index,e.row)}}},[t._v("\n            "+t._s(t.$t("robot.agv_table_more"))+"\n          ")])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:t.$t("robot.agv_table_operate"),align:"center",prop:"detail"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{plain:"",size:"mini",type:"primary"},on:{click:function(a){return t.link_mrs(e.$index,e.row)}}},[t._v("\n            "+t._s(t.$t("robot.agv_table_control"))+"\n          ")])]}}])})],2),t._v(" "),a("el-dialog",{attrs:{"close-on-click-modal":!1,title:t.$t("robot.robot_number")+"  "+t.detailId+"  "+t.$t("robot.agv_table_detail"),visible:t.dialogFormVisible,customClass:"agv-detail-wrapper"},on:{"update:visible":function(e){t.dialogFormVisible=e},close:t.oncancel,opened:t.onopen}},[a("table",{ref:"detail",attrs:{id:"detail"}},[t._l(t.details,function(e,o){return[a("tr",[a("td",[t._v(t._s(t.$t("robot.detail_"+o+".desc")))]),t._v(" "),a("td",[t._v("\n              "+t._s(t.$t("robot.detail_"+o).hasOwnProperty("map")?t.$t("robot.detail_"+o+".map."+e):e instanceof Array?e.join(" , "):e)+"\n            ")])])]})],2)])],1)},staticRenderFns:[]};var m=a("VU/8")(v,_,!1,function(t){a("UsyW"),a("3JF8"),a("ME/X"),a("+Xlh")},"data-v-8bc454a2",null);e.default=m.exports},"ME/X":function(t,e,a){var o=a("uUDn");"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);a("rjj0")("32100e94",o,!0)},NhQv:function(t,e,a){(e=a("yGwj")(!1)).push([t.i,"\n.robot-overall-pane-wrapper[data-v-8bc454a2] {\n  height: 70px;\n  margin-bottom: 10px;\n}\n.robot-overall-pane-wrapper .pane-box[data-v-8bc454a2] {\n    height: 100%;\n    padding: 0 10px 10px 0;\n}\n.robot-overall-pane-wrapper .pane-box .pane-detail[data-v-8bc454a2] {\n      height: 100%;\n      text-align: center;\n      font-size: 18px;\n      color: #a2a2a2;\n      line-height: 60px;\n      border-radius: 15px;\n      border-top: 1px solid rgba(157, 193, 148, 0.2);\n      border-bottom: 1px solid rgba(157, 193, 148, 0.17);\n}\n.robot-overall-pane-wrapper .pane-box .pane-detail[data-v-8bc454a2]:hover {\n        cursor: pointer;\n        color: chocolate;\n        border-top: 1px solid rgba(157, 193, 148, 0.6);\n        border-bottom: 1px solid rgba(157, 193, 148, 0.6);\n        -webkit-transform: scale(1.02);\n                transform: scale(1.02);\n}\n.robot-overall-pane-wrapper .pane-box .pane-detail span[data-v-8bc454a2] {\n        padding-right: 5px;\n}\n",""]),t.exports=e},SJe0:function(t,e,a){(e=a("yGwj")(!1)).push([t.i,"\n.agv-detail-wrapper > .el-dialog__header {\n  background: rgba(80, 225, 159, 0.36);\n}\n.agv-detail-wrapper > .el-dialog__body {\n  /*padding-top: 0;*/\n  background: rgba(88, 255, 182, 0.2);\n}\n",""]),t.exports=e},UsyW:function(t,e,a){var o=a("vN/s");"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);a("rjj0")("d28969dc",o,!0)},uUDn:function(t,e,a){(e=a("yGwj")(!1)).push([t.i,"\n.dialog-footer[data-v-8bc454a2] {\n  float: right;\n}\n#detail[data-v-8bc454a2] {\n  padding: 0;\n  margin: 0;\n  border-collapse: collapse;\n  width: 100%;\n}\n#detail tr[data-v-8bc454a2] {\n    background: white;\n}\n#detail tr[data-v-8bc454a2]:hover {\n    background: rgba(88, 255, 182, 0.2);\n    cursor: pointer;\n}\n#detail td[data-v-8bc454a2] {\n    border: 1px dotted #d9f6f3;\n    font-family: sans-serif;\n    padding: 5px 6px 6px 20px;\n    color: #909399;\n    width: 50%;\n}\n",""]),t.exports=e},"vN/s":function(t,e,a){(e=a("yGwj")(!1)).push([t.i,"\n.battery-box[data-v-8bc454a2] {\n  width: 100%;\n  border: 1px solid whitesmoke;\n  border-radius: 5px;\n  background-image: -webkit-gradient(linear, left top, left bottom, from(rgba(199, 199, 199, 0.29)), color-stop(white), to(rgba(199, 199, 199, 0.29)));\n  background-image: linear-gradient(rgba(199, 199, 199, 0.29), white, rgba(199, 199, 199, 0.29));\n}\n.battery-box .battery-span[data-v-8bc454a2] {\n    position: absolute;\n    margin-left: 2px;\n    line-height: 16px;\n}\n",""]),t.exports=e}});